class FollowPath{#t;#e;#i;#s;#a;#n;#r={clamp:t=>1,loop:t=>t>1?t%1:1-t%1,pingpong:t=>t>1?1-t%1:-t%1};#o;#h;path;iterations;callback;delay;easing;scale;fps;constructor(t){if(!this.#l(t))throw Error("Invalid Config.");const{element:e,duration:i,path:s,iterations:a,callback:n,rotate:r,timeline:o,toScale:h,delay:l,mode:p,easing:d}=t,c=s.getBBox(),u=s.getBoundingClientRect();this.#t=e,this.#e=i,this.path=s,this.#a=a,this.iterations=a,this.callback=n,this.delay=l,this.easing=d||(t=>t),this.#n="function"==typeof p?p:p&&Object.keys(this.#r).includes(p)?this.#r[p]:this.#r.clamp,this.scale=h?{x:u.width/c.width,y:u.height/c.height}:{x:1,y:1},this.#s=r||!1,this.#o=o,this.#h=o?Object.keys(o).map((t=>Number(t.slice(0,t.length-1)))).sort(((t,e)=>e-t)):null,this.#i=!1}animate({iterNumber:t,singleFrame:e}){if(!this.path||!this.#t||!this.#e)throw Error(`Runtime Error (FollowPath): ${this.path?this.#t?this.#e?"":"Duration":"Element":"Path"} not specified.`);t||(t=0),this.fps=void 0;let i=null;const s=this.path.getTotalLength();if((this.#a<=0||t>this.#a)&&this.callback)return this.fps=void 0,void this.callback();const a=t=>{const e=s*this.easing(t/s);return e>s||e<0?this.#n(e):e},n=t-Math.floor(t);let r=s/this.#e*(1/(this.fps||60)),o=s*n;this.iterations=t;const h=()=>{if(t=this.iterations,this.#i||t>=this.#a)return this.fps=void 0,void(!this.#i&&this.callback&&this.callback());if(o>=s)return void(t<=this.#a&&(this.delay?setTimeout((()=>requestAnimationFrame((()=>this.animate({iterNumber:t})))),this.delay):requestAnimationFrame((()=>this.animate({iterNumber:t})))));if(i){const t=Date.now()-i;this.fps=1e3/t,r=s/this.#e*t}if(this.#o&&this.#h)for(;t/this.#a*100>=this.#h[this.#h.length-1];){const t=this.#h.pop();t&&this.#o[`${t}%`]()}let e=this.path.getPointAtLength(a(o)),n=this.path.getPointAtLength(a(o+1)),l=0;if(n.x!==this.path.getPointAtLength(s).x||n.y!==this.path.getPointAtLength(s).y)l=180*Math.atan2(n.y-e.y,n.x-e.x)/Math.PI;else{let t=this.path.getPointAtLength(o-1);l=180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI}this.#t.style.transform=`translate(${e.x*this.scale.x}px, ${e.y*this.scale.y}px)${this.#s?` rotate(${l}deg)`:""}`,o+=r,t+=r/s,this.iterations=t,i=Date.now(),requestAnimationFrame(h)};i=Date.now(),requestAnimationFrame(h)}renderFrame(t){this.animate({singleFrame:!0,iterNumber:t?t/(this.#e/50*3):this.iterations})}play(){this.#i=!1,this.animate({iterNumber:this.iterations})}pause(){this.#i=!0}stop(){this.#i=!0,this.iterations=0}getProgress(){return this.iterations/this.#a*100}setProgress(t){this.iterations=t*this.#a/100}getCurrentIterationProgress(){return 100*(this.#a-Math.floor(this.#a))}setCurrentIterationProgress(t){this.iterations=Math.floor(this.iterations)+t/100}#l(t){if(!t||"object"!=typeof t||Array.isArray(t))return!1;const{duration:e,path:i,element:s,iterations:a,easing:n,mode:r,delay:o,toScale:h,rotate:l,callback:p,timeline:d}=t;if("number"!=typeof e||Number.isNaN(e)||!i||!s||"number"!=typeof a||Number.isNaN(a)||"function"!=typeof n||r&&"function"!=typeof r&&!Object.keys(this.#r).includes(r))return!1;if(void 0!==o&&("number"!=typeof o||Number.isNaN(o)))return!1;if(void 0!==h&&"boolean"!=typeof h)return!1;if(void 0!==l&&"boolean"!=typeof l)return!1;if(void 0!==p&&"function"!=typeof p)return!1;if(void 0!==d){if("object"!=typeof d||Array.isArray(d))return!1;for(const t in d){if(!/^(\d{1,3})%$/.test(t))return!1;if("function"!=typeof d[t])return!1}}return!0}}export default FollowPath;