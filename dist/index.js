class FollowPath{#t;#e;#i;#s;#a;#n;#r;#o={clamp:t=>1,loop:t=>t>1?t%1:1-t%1,pingpong:t=>t>1?1-t%1:-t%1};#h;#l;path;iterations;callback;delay;easing;scale;fps;constructor(t){if(!this.#p(t))throw Error("Invalid Config.");const{element:e,duration:i,path:s,iterations:a,callback:n,rotate:r,timeline:o,toScale:h,delay:l,mode:p,easing:u}=t,c=s.getBBox(),d=s.getBoundingClientRect();this.#t=e,this.#e=i/a,this.#i=i,this.path=s,this.#n=a,this.iterations=a,this.callback=n,this.delay=l,this.easing=u||(t=>t),this.#r="function"==typeof p?p:p&&Object.keys(this.#o).includes(p)?this.#o[p]:this.#o.clamp,this.scale=h?{x:d.width/c.width,y:d.height/c.height}:{x:1,y:1},this.#a=r||!1,this.#h=o,this.#l=o?Object.keys(o).map((t=>Number(t.slice(0,t.length-1)))).sort(((t,e)=>e-t)):null,this.#s=!1}animate(t){let e,i;if(t&&(e=t.iterNumber,i=t.singleFrame),!this.path||!this.#t||!this.#e)throw Error(`Runtime Error (FollowPath): ${this.path?this.#t?this.#e?"":"Duration":"Element":"Path"} not specified.`);e||(e=0),this.fps=void 0;let s=null;const a=this.path.getTotalLength();if((this.#n<=0||e>this.#n)&&this.callback)return this.fps=void 0,void this.callback();const n=t=>{const e=a*this.easing(t/a);return e>a||e<0?this.#r(e):e},r=e-Math.floor(e);let o=a/this.#e*(1/(this.fps||60)),h=a*r;this.iterations=e;const l=()=>{if(e=this.iterations,this.#s||e>=this.#n)return this.fps=void 0,void(!this.#s&&this.callback&&this.callback());if(h>=a)return void(e<=this.#n&&(this.delay?setTimeout((()=>requestAnimationFrame((()=>this.animate({iterNumber:e})))),this.delay):requestAnimationFrame((()=>this.animate({iterNumber:e})))));if(s){const t=Date.now()-s;this.fps=1e3/t,o=a/this.#e*t}if(this.#h&&this.#l)for(;e/this.#n*100>=this.#l[this.#l.length-1];){const t=this.#l.pop();t&&this.#h[`${t}%`]()}let t=this.path.getPointAtLength(n(h)),i=this.path.getPointAtLength(n(h+1)),r=0;if(i.x!==this.path.getPointAtLength(a).x||i.y!==this.path.getPointAtLength(a).y)r=180*Math.atan2(i.y-t.y,i.x-t.x)/Math.PI;else{let e=this.path.getPointAtLength(h-1);r=180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}this.#t.style.transform=`translate(${t.x*this.scale.x}px, ${t.y*this.scale.y}px)${this.#a?` rotate(${r}deg)`:""}`,h+=o,e+=o/a,this.iterations=e,s=Date.now(),requestAnimationFrame(l)};s=Date.now(),requestAnimationFrame(l)}renderFrame(t){this.animate({singleFrame:!0,iterNumber:t?t/(this.#i/50*3):this.iterations})}play(){this.#s=!1,this.animate({iterNumber:this.iterations})}pause(){this.#s=!0}stop(){this.#s=!0,this.iterations=0}getProgress(){return this.iterations/this.#n*100}setProgress(t){this.iterations=t*this.#n/100}getCurrentIterationProgress(){return 100*(this.#n-Math.floor(this.#n))}setCurrentIterationProgress(t){this.iterations=Math.floor(this.iterations)+t/100}#p(t){if(!t||"object"!=typeof t||Array.isArray(t))return!1;const{duration:e,path:i,element:s,iterations:a,easing:n,mode:r,delay:o,toScale:h,rotate:l,callback:p,timeline:u}=t;if("number"!=typeof e||Number.isNaN(e)||!i||!s||"number"!=typeof a||Number.isNaN(a)||"function"!=typeof n||r&&"function"!=typeof r&&!Object.keys(this.#o).includes(r))return!1;if(void 0!==o&&("number"!=typeof o||Number.isNaN(o)))return!1;if(void 0!==h&&"boolean"!=typeof h)return!1;if(void 0!==l&&"boolean"!=typeof l)return!1;if(void 0!==p&&"function"!=typeof p)return!1;if(void 0!==u){if("object"!=typeof u||Array.isArray(u))return!1;for(const t in u){if(!/^(\d{1,3})%$/.test(t))return!1;if("function"!=typeof u[t])return!1}}return!0}}export default FollowPath;